<app-header [showLinks]="false" (onExitEvent)="exit()"></app-header>

<div *ngIf="!editMode"
     class="text-center">
    <button
            type="button"
            class="btn btn-success"
            (click)="onRegisterUser()">
        Register new User
    </button>
</div>


<add-user-form
        *ngIf="editMode"
        (addedUser)="addUserToList($event)">
</add-user-form>


<hr>


<div *ngIf="errorHasOccourred" class="row">
    <div class="col-12">
        <div class="text-center">
            'ops, something went wrong :('
            <button class="alert alert-info"
                    (click)="executeUsersRequest()">
                Reload
            </button>
        </div>
    </div>
</div>


<div class="row u-card lighter-background mx-0 px-0" *ngIf="!errorHasOccourred">
    <div class="col-sm-8 col-md text-center m-auto">
        <h2>List Of Users</h2>
        <p>Users are represented using a bootstrap table</p>
    </div>

    <div class="col text-center m-auto">

        <button
                type="button" class="btn btn-primary"
                (click)="onConfirm();">
            Confirm Users
        </button>
    </div>
</div>

<hr>

<div class="container-fluid" *ngIf="!loadingCompleted ; else listLoaded">
    <div class="row">
        <div class="col-12 text-center">
            LOADING {{loadingCount*10}}%
        </div>
    </div>

    <div class="row">
        <div class="col-12">
            <div class="loading">
                <div class="progress">
                    <div class="progress-bar"
                         role="progressbar"
                         [ngStyle]="{width: loadingCount * 10 + '%' }"
                         aria-valuenow="75"
                         aria-valuemin="0"
                         aria-valuemax="100">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<hr>


<ng-template #listLoaded>
    <div scrolldirective class="mx-auto table-responsive u-card lighter-background mb-2"
         *ngIf="listOfUsers.length>0 ; else emptyList">

        <!--SCROLL TABLE-->

        <table class="table">
            <thead>
            <tr class>
                <th>ID</th>
                <th>Firstname</th>
                <th>Surname</th>
                <th>Email</th>
                <th>Manage</th>

            </tr>
            </thead>

            <tbody>
            <tr class="text-truncate" *ngFor="let user of listOfUSerOfOnePAge; let i=index">
                <td>
                    <span class="badge badge-info">
                    {{ 3 * currentPage + i }}
                    </span>
                </td>
                <td>{{user.name}}</td>
                <td>{{user.surname}}</td>
                <td>{{user.email}}</td>
                <td>
                    <div class="row">
                        <div class="col">
                            <modal-basic (deleteEvent)="onDeleteUser(user)"></modal-basic>
                        </div>

                        <div class="col">
                            <dropdown-menu [user]="user"></dropdown-menu>
                        </div>
                    </div>
                </td>
            </tr>
            </tbody>
        </table>

    </div>

    <div class="row">
        <div class="col-12">
            <nav aria-label="Page navigation example">
                <ul class="pagination">
                    <div *ngFor="let number of generateNumbers()">
                        <li class="page-item active" *ngIf="number===currentPage">
                            <a class="page-link" (click)="onPageNumberClick(number)">Page {{number}}</a>
                        </li>
                        <li class="page-item" *ngIf="number!=currentPage">
                            <a class="page-link" (click)="onPageNumberClick(number)">Page {{number}}</a>
                        </li>
                    </div>
                </ul>
            </nav>
        </div>
    </div>


    <ng-template #emptyList>
        <hr>
        <div class="text-center">_______________________ Please Register a user _______________________
        </div>
    </ng-template>

</ng-template>





